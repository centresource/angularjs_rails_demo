angular.module('angularRailsDemo', ['services', 'directives']).
config(['$routeProvider', function($routeProvider) {
  $routeProvider.
  when('/photographers',
       {templateUrl: '<%= asset_path("photographers.html") %>', controller: PhotographersCtrl}).

  when('/photographers/:photographer_id/galleries',
       {templateUrl: '<%= asset_path("galleries.html") %>', controller: GalleriesCtrl}).

  when('/photographers/:photographer_id/galleries/:gallery_id/photos',
       {templateUrl: '<%= asset_path("photos.html") %>', controller: PhotosCtrl}).

  otherwise({redirectTo: '/photographers'});
}]).

config(["$httpProvider", function(p) {
  var m = document.getElementsByTagName('meta');
  for (var i in m) {
    if (m[i].name == 'csrf-token') {
      p.defaults.headers.common['X-CSRF-Token'] = m[i].content;
      break;
    }
  }
}]);
